<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MCP Coordination System - Web Interface</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>
<body>
    <div class="container">
        <header class="header">
            <h1><i class="fas fa-network-wired"></i> MCP Coordination System</h1>
            <div class="server-status" id="server-status">
                <span class="status-indicator" id="status-indicator"></span>
                <span id="status-text">Checking...</span>
            </div>
        </header>

        <nav class="nav-tabs">
            <button class="nav-tab active" data-tab="dashboard">
                <i class="fas fa-tachometer-alt"></i> Dashboard
            </button>
            <button class="nav-tab" data-tab="projects">
                <i class="fas fa-folder-open"></i> Projects
            </button>
            <button class="nav-tab" data-tab="tasks">
                <i class="fas fa-tasks"></i> Tasks
            </button>
            <button class="nav-tab" data-tab="instances">
                <i class="fas fa-robot"></i> AI Instances
            </button>
            <button class="nav-tab" data-tab="api-test">
                <i class="fas fa-code"></i> API Test
            </button>
        </nav>

        <!-- Dashboard Tab -->
        <div class="tab-content active" id="dashboard">
            <div class="card-grid">
                <div class="card">
                    <h3><i class="fas fa-heartbeat"></i> System Health</h3>
                    <div class="metric-row">
                        <span>Status:</span>
                        <span id="system-status">-</span>
                    </div>
                    <div class="metric-row">
                        <span>Uptime:</span>
                        <span id="system-uptime">-</span>
                    </div>
                    <div class="metric-row">
                        <span>Version:</span>
                        <span id="system-version">-</span>
                    </div>
                </div>

                <div class="card">
                    <h3><i class="fas fa-chart-bar"></i> Quick Stats</h3>
                    <div class="metric-row">
                        <span>Active Projects:</span>
                        <span id="active-projects">0</span>
                    </div>
                    <div class="metric-row">
                        <span>Pending Tasks:</span>
                        <span id="pending-tasks">0</span>
                    </div>
                    <div class="metric-row">
                        <span>AI Instances:</span>
                        <span id="ai-instances">0</span>
                    </div>
                </div>

                <div class="card">
                    <h3><i class="fas fa-rocket"></i> Quick Bootstrap</h3>
                    <div class="form-group">
                        <label>Role:</label>
                        <select id="bootstrap-role">
                            <option value="COO">COO - Chief Operating Officer</option>
                            <option value="PA">PA - Personal Assistant</option>
                            <option value="PM">PM - Project Manager</option>
                            <option value="Executive">Executive - Read Only</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Instance Name:</label>
                        <input type="text" id="bootstrap-name" placeholder="e.g., Alice-2025-08-23-1400">
                    </div>
                    <button class="btn btn-primary" onclick="bootstrapInstance()">
                        <i class="fas fa-play"></i> Bootstrap Instance
                    </button>
                </div>
            </div>

            <div class="card full-width">
                <h3><i class="fas fa-terminal"></i> System Log</h3>
                <div class="log-output" id="system-log">
                    <div class="log-entry">
                        <span class="log-time">[Loading...]</span>
                        <span class="log-message">Initializing web interface...</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Projects Tab -->
        <div class="tab-content" id="projects">
            <div class="section-header">
                <h2><i class="fas fa-folder-open"></i> Project Management</h2>
                <button class="btn btn-primary" onclick="showCreateProjectModal()">
                    <i class="fas fa-plus"></i> New Project
                </button>
            </div>
            
            <div class="filter-bar">
                <input type="text" id="project-search" placeholder="Search projects..." onkeyup="filterProjects()">
                <select id="project-status-filter" onchange="filterProjects()">
                    <option value="">All Status</option>
                    <option value="active">Active</option>
                    <option value="completed">Completed</option>
                    <option value="paused">Paused</option>
                </select>
            </div>

            <div class="projects-grid" id="projects-grid">
                <div class="card placeholder">
                    <i class="fas fa-folder-plus placeholder-icon"></i>
                    <p>No projects found. Create your first project to get started!</p>
                </div>
            </div>
        </div>

        <!-- Tasks Tab -->
        <div class="tab-content" id="tasks">
            <div class="section-header">
                <h2><i class="fas fa-tasks"></i> Task Management</h2>
                <button class="btn btn-primary" onclick="showCreateTaskModal()">
                    <i class="fas fa-plus"></i> New Task
                </button>
            </div>

            <div class="filter-bar">
                <input type="text" id="task-search" placeholder="Search tasks..." onkeyup="filterTasks()">
                <select id="task-project-filter" onchange="onProjectFilterChange()">
                    <option value="">All Projects</option>
                    <!-- Projects will be populated dynamically -->
                </select>
                <select id="task-status-filter" onchange="filterTasks()">
                    <option value="">All Status</option>
                    <option value="pending">Pending</option>
                    <option value="in-progress">In Progress</option>
                    <option value="completed">Completed</option>
                </select>
                <select id="task-priority-filter" onchange="filterTasks()">
                    <option value="">All Priorities</option>
                    <option value="high">High</option>
                    <option value="medium">Medium</option>
                    <option value="low">Low</option>
                </select>
                <div class="schema-indicator" id="task-schema-indicator" title="Task Schema Version">
                    v1.0
                </div>
            </div>

            <div class="tasks-board">
                <div class="task-column">
                    <h3><i class="fas fa-clock"></i> Pending</h3>
                    <div class="task-list" id="pending-task-list">
                        <!-- Tasks will be loaded here -->
                    </div>
                </div>
                <div class="task-column">
                    <h3><i class="fas fa-play"></i> In Progress</h3>
                    <div class="task-list" id="inprogress-task-list">
                        <!-- Tasks will be loaded here -->
                    </div>
                </div>
                <div class="task-column">
                    <h3><i class="fas fa-check"></i> Completed</h3>
                    <div class="task-list" id="completed-task-list">
                        <!-- Tasks will be loaded here -->
                    </div>
                </div>
            </div>
        </div>

        <!-- AI Instances Tab -->
        <div class="tab-content" id="instances">
            <div class="section-header">
                <h2><i class="fas fa-robot"></i> AI Instance Coordination</h2>
                <button class="btn btn-primary" onclick="refreshInstances()">
                    <i class="fas fa-sync"></i> Refresh
                </button>
            </div>

            <div class="instances-grid" id="instances-grid">
                <div class="card placeholder">
                    <i class="fas fa-robot placeholder-icon"></i>
                    <p>No AI instances detected. Bootstrap an instance to get started!</p>
                </div>
            </div>
        </div>

        <!-- API Test Tab -->
        <div class="tab-content" id="api-test">
            <div class="section-header">
                <h2><i class="fas fa-code"></i> API Testing Interface</h2>
            </div>

            <div class="api-test-panel">
                <div class="form-group">
                    <label>Endpoint:</label>
                    <select id="api-endpoint">
                        <option value="/health">GET /health - Health Check</option>
                        <option value="/api/mcp/status">GET /api/mcp/status - Server Status</option>
                        <option value="/api/mcp/bootstrap">POST /api/mcp/bootstrap - Bootstrap Instance</option>
                        <option value="/api/mcp/call">POST /api/mcp/call - Function Call</option>
                    </select>
                </div>

                <div class="form-group">
                    <label>Request Body (for POST requests):</label>
                    <textarea id="api-request-body" rows="8" placeholder='{"role": "COO", "instanceId": "test-instance"}'></textarea>
                </div>

                <button class="btn btn-primary" onclick="testAPICall()">
                    <i class="fas fa-play"></i> Send Request
                </button>

                <div class="form-group">
                    <label>Response:</label>
                    <pre id="api-response" class="api-response">Click "Send Request" to test an API call...</pre>
                </div>
            </div>
        </div>
    </div>

    <!-- Modals -->
    <div class="modal" id="create-project-modal">
        <div class="modal-content">
            <h3><i class="fas fa-folder-plus"></i> Create New Project</h3>
            <form onsubmit="createProject(event)">
                <div class="form-group">
                    <label>Project Name:</label>
                    <input type="text" id="new-project-name" required>
                </div>
                <div class="form-group">
                    <label>Description:</label>
                    <textarea id="new-project-description" rows="3"></textarea>
                </div>
                <div class="form-group">
                    <label>Priority:</label>
                    <select id="new-project-priority">
                        <option value="medium">Medium</option>
                        <option value="high">High</option>
                        <option value="low">Low</option>
                    </select>
                </div>
                <div class="modal-buttons">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('create-project-modal')">Cancel</button>
                    <button type="submit" class="btn btn-primary">Create Project</button>
                </div>
            </form>
        </div>
    </div>

    <div class="modal" id="create-task-modal">
        <div class="modal-content">
            <h3><i class="fas fa-plus"></i> Create New Task</h3>
            <form onsubmit="createTask(event)">
                <div class="form-group">
                    <label>Task Title:</label>
                    <input type="text" id="new-task-title" required>
                </div>
                <div class="form-group">
                    <label>Description:</label>
                    <textarea id="new-task-description" rows="3"></textarea>
                </div>
                <div class="form-group">
                    <label>Project: <span class="required">*</span></label>
                    <select id="new-task-project" required>
                        <option value="">Select Project (Required)</option>
                    </select>
                    <small class="form-hint">Tasks must be assigned to a project in v2.0 architecture</small>
                </div>
                <div class="form-group">
                    <label>Priority:</label>
                    <select id="new-task-priority">
                        <option value="medium">Medium</option>
                        <option value="high">High</option>
                        <option value="low">Low</option>
                    </select>
                </div>
                <div class="modal-buttons">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('create-task-modal')">Cancel</button>
                    <button type="submit" class="btn btn-primary">Create Task</button>
                </div>
            </form>
        </div>
    </div>

    <script src="app.js"></script>
</body>
</html>